---
// Componente para gestionar diferentes tipos de fondos animados
// Lee la preferencia del usuario desde localStorage

  export interface Props {
  type?: 'particles' | 'crystal' | 'nebula' | 'none';
}const { type = 'particles' } = Astro.props;

import ParticleBackground from './ParticleBackground.astro';
import CrystalBackground from './CrystalBackground.astro';
import NebulaBackground from './NebulaBackground.astro';
---

<!-- Renderizar TODOS los fondos (se mostrará/ocultará con CSS) -->
<div id="particles-container">
  <ParticleBackground />
</div>
<div id="crystal-container">
  <CrystalBackground />
</div>
<div id="nebula-container">
  <NebulaBackground />
</div>

<script is:inline>
  // Aplicar fondo basado en preferencia del usuario
  function applyUserBackground() {
    const savedBackground = localStorage.getItem('codextreme-background') || 'particles';
    
    // Ocultar todos los contenedores primero
    const containers = ['particles-container', 'crystal-container', 'nebula-container'];
    containers.forEach(containerId => {
      const container = document.getElementById(containerId);
      if (container) {
        container.style.display = 'none';
      }
    });
    
    // Mostrar solo el contenedor seleccionado (si no es 'none')
    if (savedBackground !== 'none') {
      const activeContainer = document.getElementById(savedBackground + '-container');
      if (activeContainer) {
        activeContainer.style.display = 'block';
      }
    }
  }

  // Aplicar fondo cuando la página cargue
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', applyUserBackground);
  } else {
    setTimeout(applyUserBackground, 100);
  }
</script>
